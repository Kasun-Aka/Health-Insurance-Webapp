<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Policies | Health Insurance Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1E40AF',
                        secondary: '#2563EB',
                        accent: '#60A5FA',
                        neutral: '#F3F4F6',
                    },
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif']
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-neutral min-h-screen font-sans text-gray-800">

<!-- HEADER -->
<header class="bg-primary text-white shadow-md px-8 py-4 flex justify-between items-center">
    <h1 class="text-2xl font-semibold tracking-wide">My Enrolled Policies</h1>
    <form th:action="@{/logout}" method="get">
        <button type="submit"
                class="bg-red-500 hover:bg-red-600 text-white px-5 py-2 rounded-lg font-medium transition duration-300">
            Logout
        </button>
    </form>
</header>

<!-- NAVIGATION -->
<div class="max-w-6xl mx-auto mt-8 flex justify-between flex-wrap gap-4 px-4">
    <a th:href="@{/policies}"
       class="bg-secondary hover:bg-blue-700 text-white px-5 py-2 rounded-lg shadow-md font-medium transition duration-300">
        ← Back to All Policies
    </a>
</div>

<!-- MAIN CONTENT -->
<main class="max-w-6xl mx-auto mt-10 bg-white/90 backdrop-blur-lg rounded-2xl shadow-xl p-8">
    <div th:if="${userPolicies != null and !userPolicies.isEmpty()}">

        <!-- TABLE -->
        <div class="overflow-x-auto">
            <table class="min-w-full border border-gray-200 divide-y divide-gray-200 rounded-lg">
                <thead class="bg-blue-50">
                <tr>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 uppercase">Policy Name</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 uppercase">Duration (Days)</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 uppercase">Total Premium</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 uppercase">Paid Amount</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 uppercase">Claimable (LKR)</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 uppercase">Start Date</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 uppercase">End Date</th>
                    <th class="px-6 py-3 text-center text-sm font-semibold text-gray-700 uppercase">Action</th>
                </tr>
                </thead>
                <tbody class="divide-y divide-gray-100 bg-white">
                <tr th:each="up : ${userPolicies}" class="hover:bg-gray-50 transition">
                    <td class="px-6 py-4 text-gray-800 font-medium" th:text="${up.policy.policyName}">Policy Name</td>
                    <td class="px-6 py-4 text-gray-700" th:text="${up.policy.durationDays}">30</td>
                    <td class="px-6 py-4 text-gray-700" th:text="${up.totalPremium}">0.00</td>
                    <td class="px-6 py-4 text-gray-700" th:text="${up.paidAmount}">0.00</td>
                    <td class="px-6 py-4 text-blue-700 font-semibold" th:text="${up.policy.claimable}">0.00</td>
                    <td class="px-6 py-4 text-gray-600" th:text="${up.startDate}">2025-01-01</td>
                    <td class="px-6 py-4 text-gray-600" th:text="${up.endDate}">2025-12-31</td>
                    <td class="px-6 py-4 text-center">
                        <form th:action="@{/policies/cancel}" method="post" class="inline">
                            <input type="hidden" name="userPolicyId" th:value="${up.id}" />
                            <button type="submit"
                                    class="bg-red-500 hover:bg-red-600 text-white px-4 py-1.5 rounded-md font-medium text-sm shadow transition">
                                Cancel
                            </button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- SUMMARY CARD -->
        <div class="mt-8 bg-blue-50 border border-blue-200 rounded-xl p-6 flex justify-between items-center">
            <span class="text-lg font-semibold text-gray-700">Total Claimable Amount:</span>
            <span class="text-2xl font-bold text-primary" th:text="${totalClaimable}">0.00</span>
            <span class="text-lg font-semibold text-gray-700">LKR</span>
        </div>
    </div>

    <!-- IF NO POLICIES -->
    <div th:if="${userPolicies == null or userPolicies.isEmpty()}"
         class="text-center text-gray-500 py-12 text-lg font-medium">
        You haven’t enrolled in any policies yet.
    </div>
</main>

<!-- FOOTER -->
<footer class="text-center text-gray-500 text-sm mt-16 pb-6">
    <p>© 2025 <span class="font-semibold text-primary">Health Insurance Portal</span>. All rights reserved.</p>
</footer>

</body>
</html>
